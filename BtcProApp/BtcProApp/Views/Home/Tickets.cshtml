<script src="~/Scripts/angular.min.js"></script>
<script src="~/app/scripts/TicketController.js"></script>

<section class="wrapper">
    <div ng-app="app" ng-controller="Ticket" ng-cloak>
        <div class="row">
            <div class="col-sm-12">
                <section class="panel">
                    <header class="panel-heading">
                        <i class="fa fa-lock" style="color:green"></i> Tickets
                    </header>
                    <div class="panel-body">
                        <form name="TicketFrm" ng-hide="isIframe">
                            <table style="width:50%;margin:0 auto" class="table table-bordered">
                                <tr>
                                    <td style="width:25%;text-align:right"><label>Select Ticket Category:</label></td>
                                    <td>
                                        <select name="oTicketType" ng-model="ticketType" placeholder="Select an option" ng-required="true" class="form-control">
                                            <option value="A">Business building queries</option>
                                            <option value="B">Bitcoin deposit in Account</option>
                                            <option value="C">Financial</option>
                                            <option value="D">Founder upgrade</option>
                                            <option value="E">From support email</option>
                                            <option value="F">General</option>
                                            <option value="G">Personal information error</option>
                                            <option value="H">Product queries</option>
                                            <option value="I">Website error</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:25%;text-align:right"><label>Subject:</label></td>
                                    <td><input type="text" ng-model="subjectName" class="form-control" ng-required="true" /></td>
                                </tr>
                                <tr>
                                    <td style="width:25%;text-align:right"><label>Message:</label></td>
                                    <td><textarea ng-model="documentComments" class="form-control" rows="8" ng-required="true"></textarea></td>
                                </tr>
                                <tr>
                                    <td style="width:25%;text-align:right"><label>Priority:</label></td>
                                    <td>
                                        <select name="oTicketPriority" ng-model="ticketPriority" placeholder="Select an option" ng-required="true" class="form-control">
                                            <option value="V">Very low</option>
                                            <option value="L">Low</option>
                                            <option value="N">Normal</option>
                                            <option value="H">High</option>
                                            <option value="C">Critical</option>
                                        </select>
                                    </td>

                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <div style="width:100%">
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" ng-hide="TicketFrm.$invalid || disableSubmit" style="border:1px solid #dcd4d4 !important;min-height: 50px; margin-bottom: 10px;padding-top: 12px;">
                                                <input type="file" id="documentA" name="file" onchange="angular.element(this).scope().uploadLibraryDocumentA(this.files)" /><span style="float:right;margin-top:-25px" ng-required="true"></span>@*<img src="/Content/progress.gif" />*@
                                            </div>
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4" style="padding-top:15px;text-align:center">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                            <div style="text-align:center;margin-top:10px;margin-bottom:20px">
                                <button type="button" value="Submit" ng-disabled="TicketFrm.$invalid || disableSubmit ||isAttachmentUploadingA" ng-click="disableSubmit=true;submitTicket()" class="btn btn-primary">Submit</button>
                            </div>
                        </form>
                        <table style="width:100%;margin:0 auto" class="table table-bordered table-striped" ng-hide="isIframe">
                            <tr>
                                <th style="width:15%">Date</th>
                                <th style="width:10%">Category</th>
                                <th >Subject</th>
                                <th >Message</th>
                                <th style="width:5%">Attachment</th>
                                <th style="width:20%">Admin response</th>
                                <th style="width:15%">Status</th>
                            </tr>
                            <tr ng-repeat="ticket in mytickets">
                                <td>{{ticket.DateString}}</td>
                                <td>{{ticket.TicketCategory | TypeFilter}}</td>
                                <td>{{ticket.Subject}}</td>
                                <td>{{ticket.Message}}</td>
                                <td style="text-align:center;cursor:pointer"><i ng-if="ticket.Id>0" class="fa fa-clipboard" ng-click="showimage(ticket.Id)"></i></td>
                                <td>{{ticket.Status}}</td>
                                <td>{{ticket.Comment}}</td>
                            </tr>
                        </table>
                        <div ng-show="isIframe">
                            <div class="panel-heading" style="margin-top:25px;width:100%;height:50px;background-color:rgba(35, 183, 229, 0.37)">
                                <div class="pull-left">
                                    <label style="padding:5px;padding-top:0px;font-weight: bolder;font-size: medium;">Attachment File Name : {{documentNAME}} </label>
                                </div>
                                <div class="pull-right">
                                    <a><i class="fa fa-2x fa-times" ng-click="isIframe=false"></i></a>
                                </div>
                            </div>
                            <div class="panel-body col-sm-12" style="background-color:white; min-height:750px;position:relative">
                                <div>
                                    <image ng-if="documentFILETYPE=='IMAGE'" src="{{fullFilePath}}" style="max-height:100%;max-width:100%" />
                                    <div ng-if="documentFILETYPE=='PDF' || documentFILETYPE=='WORD' || documentFILETYPE=='EXCEL' || documentFILETYPE=='POWERPOINT' || documentFILETYPE=='TEXT' || documentFILETYPE=='HTML'">
                                        <div ng-bind-html="TrustedviewerFullFilePath"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</section>


